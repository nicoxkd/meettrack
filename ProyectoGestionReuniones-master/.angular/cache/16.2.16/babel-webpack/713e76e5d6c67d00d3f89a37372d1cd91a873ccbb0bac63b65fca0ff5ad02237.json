{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { forkJoin } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../shared/services/modal.service\";\nimport * as i2 from \"../calendario/views/services/disponibilidad.service\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = function (a0, a1, a2, a3) {\n  return {\n    \"empty\": a0,\n    \"disabled\": a1,\n    \"available\": a2,\n    \"selected\": a3\n  };\n};\nfunction CalendarioProfesorComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵlistener(\"click\", function CalendarioProfesorComponent_div_29_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const day_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectDay(day_r2));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const day_r2 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction4(2, _c0, day_r2.empty, day_r2.disabled, !day_r2.empty && !day_r2.disabled, (ctx_r0.selectedDate == null ? null : ctx_r0.selectedDate.getDate()) === day_r2.day && !day_r2.empty && !day_r2.disabled));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", day_r2.empty ? \"\" : day_r2.day, \" \");\n  }\n}\nfunction CalendarioProfesorComponent_button_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function CalendarioProfesorComponent_button_34_Template_button_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const h_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.toggleHour(h_r5));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const h_r5 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"selected\", ctx_r1.selectedHours.includes(h_r5));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", h_r5, \" \");\n  }\n}\nexport class CalendarioProfesorComponent {\n  constructor(modalService, disponibilidadService) {\n    this.modalService = modalService;\n    this.disponibilidadService = disponibilidadService;\n    this.currentDate = new Date();\n    this.selectedDate = null;\n    this.dniProfesor = '';\n    // Lista de horas seleccionadas para el día actual\n    this.selectedHours = [];\n    // Mapa de fecha -> Array de horas ya publicadas\n    this.publishedAvailability = new Map();\n    this.monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];\n    this.calendarDays = [];\n    this.hours = ['08:30 - 09:25', '09:30 - 10:25', '11:00 - 11:55', '12:00 - 12:55', '13:00 - 13:55', '14:00 - 14:55'];\n  }\n  ngOnInit() {\n    this.dniProfesor = localStorage.getItem('dni') || '';\n    if (this.dniProfesor) {\n      this.loadProfessorAvailability();\n    } else {\n      this.modalService.alert('Error', 'No se encontró el DNI del profesor. Por favor, inicie sesión.');\n    }\n  }\n  loadProfessorAvailability() {\n    this.disponibilidadService.getPorProfesor(this.dniProfesor).subscribe({\n      next: slots => {\n        this.publishedAvailability.clear();\n        slots.forEach(slot => {\n          const dateObj = new Date(slot.fecha);\n          const dateKey = this.formatDateKey(dateObj);\n          if (!this.publishedAvailability.has(dateKey)) {\n            this.publishedAvailability.set(dateKey, []);\n          }\n          this.publishedAvailability.get(dateKey)?.push(slot.hora);\n        });\n        this.renderCalendar();\n      },\n      error: err => console.error('Error cargando disponibilidad del profesor', err)\n    });\n  }\n  formatDateKey(date) {\n    const year = date.getFullYear();\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const day = date.getDate().toString().padStart(2, '0');\n    return `${year}-${month}-${day}`;\n  }\n  renderCalendar() {\n    const year = this.currentDate.getFullYear();\n    const month = this.currentDate.getMonth();\n    const firstDay = new Date(year, month, 1);\n    const lastDay = new Date(year, month + 1, 0);\n    let startDay = firstDay.getDay();\n    startDay = startDay === 0 ? 6 : startDay - 1;\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    this.calendarDays = [];\n    for (let i = 0; i < startDay; i++) {\n      this.calendarDays.push({\n        day: 0,\n        disabled: false,\n        empty: true,\n        hasSlots: false\n      });\n    }\n    for (let day = 1; day <= lastDay.getDate(); day++) {\n      const currentDayDate = new Date(year, month, day);\n      const dateKey = this.formatDateKey(currentDayDate);\n      const hasSlots = this.publishedAvailability.has(dateKey);\n      const disabled = currentDayDate < today && !this.isSameDay(currentDayDate, today);\n      this.calendarDays.push({\n        day,\n        disabled,\n        empty: false,\n        hasSlots\n      });\n    }\n  }\n  isSameDay(d1, d2) {\n    return d1.getFullYear() === d2.getFullYear() && d1.getMonth() === d2.getMonth() && d1.getDate() === d2.getDate();\n  }\n  prevMonth() {\n    this.currentDate.setMonth(this.currentDate.getMonth() - 1);\n    this.renderCalendar();\n  }\n  nextMonth() {\n    this.currentDate.setMonth(this.currentDate.getMonth() + 1);\n    this.renderCalendar();\n  }\n  selectDay(day) {\n    if (day.disabled || day.empty) return;\n    this.selectedDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), day.day);\n    const dateKey = this.formatDateKey(this.selectedDate);\n    this.selectedHours = [...(this.publishedAvailability.get(dateKey) || [])];\n  }\n  toggleHour(hour) {\n    const index = this.selectedHours.indexOf(hour);\n    if (index > -1) {\n      this.selectedHours.splice(index, 1);\n    } else {\n      this.selectedHours.push(hour);\n    }\n  }\n  saveAvailability() {\n    if (!this.selectedDate || this.selectedHours.length === 0) {\n      this.modalService.alert('Atención', 'Por favor, selecciona una fecha y al menos una hora.');\n      return;\n    }\n    const fechaStr = this.formatDateKey(this.selectedDate);\n    const dateKey = this.formatDateKey(this.selectedDate);\n    const existingHours = this.publishedAvailability.get(dateKey) || [];\n    // Ver cuáles son nuevas (están en selectedHours pero no en existingHours)\n    const newHours = this.selectedHours.filter(h => !existingHours.includes(h));\n    if (newHours.length === 0) {\n      this.modalService.alert('Información', 'No has añadido horas nuevas para esta fecha.');\n      return;\n    }\n    this.modalService.confirm('Publicar disponibilidad', `¿Deseas publicar ${newHours.length} nuevo(s) hueco(s) para el ${fechaStr}?`, 'Publicar').then(confirmed => {\n      if (confirmed) {\n        const requests = newHours.map(hora => this.disponibilidadService.crearDisponibilidad({\n          fecha: fechaStr,\n          hora: hora,\n          id_profesor: this.dniProfesor\n        }));\n        forkJoin(requests).subscribe({\n          next: () => {\n            this.modalService.alert('Éxito', 'Disponibilidad publicada correctamente.');\n            this.loadProfessorAvailability();\n          },\n          error: err => {\n            console.error('Error al publicar disponibilidad', err);\n            this.modalService.alert('Error', 'Hubo un error al guardar la disponibilidad.');\n          }\n        });\n      }\n    });\n  }\n  getMonthYear() {\n    return `${this.monthNames[this.currentDate.getMonth()]} ${this.currentDate.getFullYear()}`;\n  }\n  static {\n    this.ɵfac = function CalendarioProfesorComponent_Factory(t) {\n      return new (t || CalendarioProfesorComponent)(i0.ɵɵdirectiveInject(i1.ModalService), i0.ɵɵdirectiveInject(i2.DisponibilidadService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CalendarioProfesorComponent,\n      selectors: [[\"app-calendario-profesor\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 37,\n      vars: 3,\n      consts: [[1, \"main-content\"], [1, \"container\"], [1, \"calendar-section\"], [1, \"calendar\"], [1, \"calendar-header\"], [1, \"nav-btn-cal\", 3, \"click\"], [1, \"calendar-weekdays\"], [1, \"weekday\"], [1, \"calendar-days\"], [\"class\", \"day\", 3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"hours-panel\"], [1, \"hours-container\"], [\"class\", \"hour-btn\", 3, \"selected\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"confirm-btn\", 3, \"click\"], [1, \"day\", 3, \"ngClass\", \"click\"], [1, \"hour-btn\", 3, \"click\"]],\n      template: function CalendarioProfesorComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"main\", 0)(1, \"div\", 1)(2, \"section\", 2)(3, \"h2\");\n          i0.ɵɵtext(4, \"Ingl\\u00E9s Profesional\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"div\", 3)(6, \"div\", 4)(7, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function CalendarioProfesorComponent_Template_button_click_7_listener() {\n            return ctx.prevMonth();\n          });\n          i0.ɵɵtext(8, \"<\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"h3\");\n          i0.ɵɵtext(10);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function CalendarioProfesorComponent_Template_button_click_11_listener() {\n            return ctx.nextMonth();\n          });\n          i0.ɵɵtext(12, \">\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(13, \"div\", 6)(14, \"div\", 7);\n          i0.ɵɵtext(15, \"Lun\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"div\", 7);\n          i0.ɵɵtext(17, \"Mar\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(18, \"div\", 7);\n          i0.ɵɵtext(19, \"Mi\\u00E9\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"div\", 7);\n          i0.ɵɵtext(21, \"Jue\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(22, \"div\", 7);\n          i0.ɵɵtext(23, \"Vie\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(24, \"div\", 7);\n          i0.ɵɵtext(25, \"S\\u00E1b\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(26, \"div\", 7);\n          i0.ɵɵtext(27, \"Dom\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(28, \"div\", 8);\n          i0.ɵɵtemplate(29, CalendarioProfesorComponent_div_29_Template, 2, 7, \"div\", 9);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(30, \"aside\", 10)(31, \"h2\");\n          i0.ɵɵtext(32, \"Seleccione las horas libres\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(33, \"div\", 11);\n          i0.ɵɵtemplate(34, CalendarioProfesorComponent_button_34_Template, 2, 3, \"button\", 12);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(35, \"button\", 13);\n          i0.ɵɵlistener(\"click\", function CalendarioProfesorComponent_Template_button_click_35_listener() {\n            return ctx.confirmMeeting();\n          });\n          i0.ɵɵtext(36, \"Confirmar selecci\\u00F3n\");\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(10);\n          i0.ɵɵtextInterpolate(ctx.getMonthYear());\n          i0.ɵɵadvance(19);\n          i0.ɵɵproperty(\"ngForOf\", ctx.calendarDays);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngForOf\", ctx.hours);\n        }\n      },\n      dependencies: [CommonModule, i3.NgClass, i3.NgForOf],\n      styles: [\".main-content[_ngcontent-%COMP%] {\\n  padding: 20px;\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.container[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: 1fr 350px;\\n  gap: 30px;\\n  background-color: #f5f5f5;\\n  padding: 30px;\\n  border-radius: 12px;\\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\\n  max-width: 1100px;\\n  width: 100%;\\n}\\n\\n\\n\\n.calendar-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  margin-bottom: 20px;\\n  color: #333;\\n}\\n\\n.calendar[_ngcontent-%COMP%] {\\n  background: white;\\n  padding: 20px;\\n  border-radius: 10px;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 20px;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]   .nav-btn-cal[_ngcontent-%COMP%] {\\n  background: #1e88e5;\\n  color: white;\\n  border: none;\\n  padding: 5px 15px;\\n  border-radius: 5px;\\n  cursor: pointer;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-weekdays[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: repeat(7, 1fr);\\n  font-weight: bold;\\n  color: #666;\\n  margin-bottom: 10px;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-days[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: repeat(7, 1fr);\\n  gap: 5px;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-days[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%] {\\n  padding: 15px 5px;\\n  text-align: center;\\n  cursor: pointer;\\n  border-radius: 5px;\\n  transition: 0.3s;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-days[_ngcontent-%COMP%]   .day.available[_ngcontent-%COMP%]:hover {\\n  background-color: #e3f2fd;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-days[_ngcontent-%COMP%]   .day.selected[_ngcontent-%COMP%] {\\n  background-color: #1e88e5;\\n  color: white;\\n  font-weight: bold;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-days[_ngcontent-%COMP%]   .day.disabled[_ngcontent-%COMP%] {\\n  color: #ccc;\\n  cursor: not-allowed;\\n}\\n.calendar[_ngcontent-%COMP%]   .calendar-days[_ngcontent-%COMP%]   .day.empty[_ngcontent-%COMP%] {\\n  cursor: default;\\n}\\n\\n\\n\\n.hours-panel[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n}\\n.hours-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  font-size: 1.2rem;\\n  margin-bottom: 20px;\\n  color: #333;\\n}\\n.hours-panel[_ngcontent-%COMP%]   .hours-container[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: 1fr;\\n  gap: 12px;\\n  margin-bottom: 25px;\\n}\\n.hours-panel[_ngcontent-%COMP%]   .hour-btn[_ngcontent-%COMP%] {\\n  padding: 15px;\\n  border: 2px solid #42A5F5;\\n  border-radius: 8px;\\n  font-size: 1rem;\\n  cursor: pointer;\\n  transition: all 0.3s ease;\\n  background-color: white;\\n  color: #42A5F5;\\n}\\n.hours-panel[_ngcontent-%COMP%]   .hour-btn.selected[_ngcontent-%COMP%] {\\n  background-color: #42A5F5;\\n  color: white;\\n}\\n.hours-panel[_ngcontent-%COMP%]   .hour-btn[_ngcontent-%COMP%]:hover:not(.selected) {\\n  background-color: #f0f8ff;\\n}\\n.hours-panel[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%] {\\n  padding: 15px;\\n  background-color: #2e7d32;\\n  color: white;\\n  border: none;\\n  border-radius: 8px;\\n  font-weight: bold;\\n  cursor: pointer;\\n  transition: 0.3s;\\n}\\n.hours-panel[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]:hover {\\n  background-color: #1b5e20;\\n}\\n\\n\\n\\n@media (max-width: 850px) {\\n  .container[_ngcontent-%COMP%] {\\n    grid-template-columns: 1fr;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZXMvY2FsZW5kYXJpby1wcm9mZXNvci9jYWxlbmRhcmlvLXByb2Zlc29yLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBQTtFQUNBLGFBQUE7RUFDQSx1QkFBQTtBQUNGOztBQUVBO0VBQ0UsYUFBQTtFQUNBLGdDQUFBO0VBQ0EsU0FBQTtFQUNBLHlCQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0EseUNBQUE7RUFDQSxpQkFBQTtFQUNBLFdBQUE7QUFDRjs7QUFFQSx1QkFBQTtBQUNBO0VBQXVCLG1CQUFBO0VBQXFCLFdBQUE7QUFHNUM7O0FBREE7RUFDRSxpQkFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtBQUlGO0FBRkU7RUFDRSxhQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtFQUNBLG1CQUFBO0FBSUo7QUFGSTtFQUNFLG1CQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtBQUlOO0FBQUU7RUFDRSxhQUFBO0VBQ0EscUNBQUE7RUFDQSxpQkFBQTtFQUNBLFdBQUE7RUFDQSxtQkFBQTtBQUVKO0FBQ0U7RUFDRSxhQUFBO0VBQ0EscUNBQUE7RUFDQSxRQUFBO0FBQ0o7QUFDSTtFQUNFLGlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQUNOO0FBQ007RUFBb0IseUJBQUE7QUFFMUI7QUFETTtFQUFhLHlCQUFBO0VBQTJCLFlBQUE7RUFBYyxpQkFBQTtBQU01RDtBQUxNO0VBQWEsV0FBQTtFQUFhLG1CQUFBO0FBU2hDO0FBUk07RUFBVSxlQUFBO0FBV2hCOztBQU5BLDJCQUFBO0FBQ0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7QUFTRjtBQVBFO0VBQUssaUJBQUE7RUFBbUIsbUJBQUE7RUFBcUIsV0FBQTtBQVkvQztBQVZFO0VBQ0UsYUFBQTtFQUNBLDBCQUFBO0VBQ0EsU0FBQTtFQUNBLG1CQUFBO0FBWUo7QUFURTtFQUNFLGFBQUE7RUFDQSx5QkFBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtFQUNBLGVBQUE7RUFDQSx5QkFBQTtFQUdBLHVCQUFBO0VBQ0EsY0FBQTtBQVNKO0FBTkk7RUFDRSx5QkFBQTtFQUNBLFlBQUE7QUFRTjtBQUxJO0VBQ0UseUJBQUE7QUFPTjtBQUhFO0VBQ0UsYUFBQTtFQUNBLHlCQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0FBS0o7QUFISTtFQUFVLHlCQUFBO0FBTWQ7O0FBRkEsZUFBQTtBQUNBO0VBQ0U7SUFBYSwwQkFBQTtFQU1iO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIubWFpbi1jb250ZW50IHtcbiAgcGFkZGluZzogMjBweDtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cbi5jb250YWluZXIge1xuICBkaXNwbGF5OiBncmlkO1xuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAzNTBweDtcbiAgZ2FwOiAzMHB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmNWY1O1xuICBwYWRkaW5nOiAzMHB4O1xuICBib3JkZXItcmFkaXVzOiAxMnB4O1xuICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwwLDAsMC4xKTtcbiAgbWF4LXdpZHRoOiAxMTAwcHg7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4vKiAtLS0gQ0FMRU5EQVJJTyAtLS0gKi9cbi5jYWxlbmRhci1zZWN0aW9uIGgyIHsgbWFyZ2luLWJvdHRvbTogMjBweDsgY29sb3I6ICMzMzM7IH1cblxuLmNhbGVuZGFyIHtcbiAgYmFja2dyb3VuZDogd2hpdGU7XG4gIHBhZGRpbmc6IDIwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XG4gIFxuICAuY2FsZW5kYXItaGVhZGVyIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XG4gICAgXG4gICAgLm5hdi1idG4tY2FsIHtcbiAgICAgIGJhY2tncm91bmQ6ICMxZTg4ZTU7XG4gICAgICBjb2xvcjogd2hpdGU7XG4gICAgICBib3JkZXI6IG5vbmU7XG4gICAgICBwYWRkaW5nOiA1cHggMTVweDtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICB9XG4gIH1cblxuICAuY2FsZW5kYXItd2Vla2RheXMge1xuICAgIGRpc3BsYXk6IGdyaWQ7XG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoNywgMWZyKTtcbiAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICBjb2xvcjogIzY2NjtcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICB9XG5cbiAgLmNhbGVuZGFyLWRheXMge1xuICAgIGRpc3BsYXk6IGdyaWQ7XG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoNywgMWZyKTtcbiAgICBnYXA6IDVweDtcblxuICAgIC5kYXkge1xuICAgICAgcGFkZGluZzogMTVweCA1cHg7XG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgICB0cmFuc2l0aW9uOiAwLjNzO1xuXG4gICAgICAmLmF2YWlsYWJsZTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ICNlM2YyZmQ7IH1cbiAgICAgICYuc2VsZWN0ZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMWU4OGU1OyBjb2xvcjogd2hpdGU7IGZvbnQtd2VpZ2h0OiBib2xkOyB9XG4gICAgICAmLmRpc2FibGVkIHsgY29sb3I6ICNjY2M7IGN1cnNvcjogbm90LWFsbG93ZWQ7IH1cbiAgICAgICYuZW1wdHkgeyBjdXJzb3I6IGRlZmF1bHQ7IH1cbiAgICB9XG4gIH1cbn1cblxuLyogLS0tIFBBTkVMIERFIEhPUkFTIC0tLSAqL1xuLmhvdXJzLXBhbmVsIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgXG4gIGgyIHsgZm9udC1zaXplOiAxLjJyZW07IG1hcmdpbi1ib3R0b206IDIwcHg7IGNvbG9yOiAjMzMzOyB9XG5cbiAgLmhvdXJzLWNvbnRhaW5lciB7XG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjtcbiAgICBnYXA6IDEycHg7XG4gICAgbWFyZ2luLWJvdHRvbTogMjVweDtcbiAgfVxuXG4gIC5ob3VyLWJ0biB7XG4gICAgcGFkZGluZzogMTVweDtcbiAgICBib3JkZXI6IDJweCBzb2xpZCAjNDJBNUY1O1xuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICBmb250LXNpemU6IDFyZW07XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7XG4gICAgXG4gICAgLy8gRVNUQURPIERFU01BUkNBRE8gKFBvciBkZWZlY3RvKVxuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICAgIGNvbG9yOiAjNDJBNUY1O1xuXG4gICAgLy8gRVNUQURPIE1BUkNBRE9cbiAgICAmLnNlbGVjdGVkIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0MkE1RjU7XG4gICAgICBjb2xvcjogd2hpdGU7XG4gICAgfVxuXG4gICAgJjpob3Zlcjpub3QoLnNlbGVjdGVkKSB7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmOGZmO1xuICAgIH1cbiAgfVxuXG4gIC5jb25maXJtLWJ0biB7XG4gICAgcGFkZGluZzogMTVweDtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmU3ZDMyO1xuICAgIGNvbG9yOiB3aGl0ZTtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICB0cmFuc2l0aW9uOiAwLjNzO1xuXG4gICAgJjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ICMxYjVlMjA7IH1cbiAgfVxufVxuXG4vKiBSZXNwb25zaXZlICovXG5AbWVkaWEgKG1heC13aWR0aDogODUwcHgpIHtcbiAgLmNvbnRhaW5lciB7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyOyB9XG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["CommonModule","forkJoin","i0","ɵɵelementStart","ɵɵlistener","CalendarioProfesorComponent_div_29_Template_div_click_0_listener","restoredCtx","ɵɵrestoreView","_r4","day_r2","$implicit","ctx_r3","ɵɵnextContext","ɵɵresetView","selectDay","ɵɵtext","ɵɵelementEnd","ɵɵproperty","ɵɵpureFunction4","_c0","empty","disabled","ctx_r0","selectedDate","getDate","day","ɵɵadvance","ɵɵtextInterpolate1","CalendarioProfesorComponent_button_34_Template_button_click_0_listener","_r7","h_r5","ctx_r6","toggleHour","ɵɵclassProp","ctx_r1","selectedHours","includes","CalendarioProfesorComponent","constructor","modalService","disponibilidadService","currentDate","Date","dniProfesor","publishedAvailability","Map","monthNames","calendarDays","hours","ngOnInit","localStorage","getItem","loadProfessorAvailability","alert","getPorProfesor","subscribe","next","slots","clear","forEach","slot","dateObj","fecha","dateKey","formatDateKey","has","set","get","push","hora","renderCalendar","error","err","console","date","year","getFullYear","month","getMonth","toString","padStart","firstDay","lastDay","startDay","getDay","today","setHours","i","hasSlots","currentDayDate","isSameDay","d1","d2","prevMonth","setMonth","nextMonth","hour","index","indexOf","splice","saveAvailability","length","fechaStr","existingHours","newHours","filter","h","confirm","then","confirmed","requests","map","crearDisponibilidad","id_profesor","getMonthYear","ɵɵdirectiveInject","i1","ModalService","i2","DisponibilidadService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","CalendarioProfesorComponent_Template","rf","ctx","CalendarioProfesorComponent_Template_button_click_7_listener","CalendarioProfesorComponent_Template_button_click_11_listener","ɵɵtemplate","CalendarioProfesorComponent_div_29_Template","CalendarioProfesorComponent_button_34_Template","CalendarioProfesorComponent_Template_button_click_35_listener","confirmMeeting","ɵɵtextInterpolate","i3","NgClass","NgForOf","styles"],"sources":["C:\\Users\\nicoc\\Downloads\\meetracks\\proyectoNuevo\\ProyectoGestionReuniones-master\\src\\app\\features\\calendario-profesor\\calendario-profesor.component.ts","C:\\Users\\nicoc\\Downloads\\meetracks\\proyectoNuevo\\ProyectoGestionReuniones-master\\src\\app\\features\\calendario-profesor\\calendario-profesor.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ModalService } from '../../shared/services/modal.service';\nimport { DisponibilidadService } from '../calendario/views/services/disponibilidad.service';\nimport { forkJoin } from 'rxjs';\n\n@Component({\n  selector: 'app-calendario-profesor',\n  standalone: true,\n  imports: [CommonModule],\n  templateUrl: './calendario-profesor.component.html',\n  styleUrls: ['./calendario-profesor.component.scss']\n})\nexport class CalendarioProfesorComponent implements OnInit {\n\n  currentDate: Date = new Date();\n  selectedDate: Date | null = null;\n  dniProfesor: string = '';\n\n  // Lista de horas seleccionadas para el día actual\n  selectedHours: string[] = [];\n\n  // Mapa de fecha -> Array de horas ya publicadas\n  publishedAvailability: Map<string, string[]> = new Map();\n\n  monthNames: string[] = [\n    'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',\n    'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'\n  ];\n\n  calendarDays: { day: number, disabled: boolean, empty: boolean, hasSlots: boolean }[] = [];\n\n  hours: string[] = [\n    '08:30 - 09:25',\n    '09:30 - 10:25',\n    '11:00 - 11:55',\n    '12:00 - 12:55',\n    '13:00 - 13:55',\n    '14:00 - 14:55'\n  ];\n\n  constructor(\n    private modalService: ModalService,\n    private disponibilidadService: DisponibilidadService\n  ) { }\n\n  ngOnInit(): void {\n    this.dniProfesor = localStorage.getItem('dni') || '';\n    if (this.dniProfesor) {\n      this.loadProfessorAvailability();\n    } else {\n      this.modalService.alert('Error', 'No se encontró el DNI del profesor. Por favor, inicie sesión.');\n    }\n  }\n\n  loadProfessorAvailability() {\n    this.disponibilidadService.getPorProfesor(this.dniProfesor).subscribe({\n      next: (slots) => {\n        this.publishedAvailability.clear();\n        slots.forEach(slot => {\n          const dateObj = new Date(slot.fecha);\n          const dateKey = this.formatDateKey(dateObj);\n          if (!this.publishedAvailability.has(dateKey)) {\n            this.publishedAvailability.set(dateKey, []);\n          }\n          this.publishedAvailability.get(dateKey)?.push(slot.hora);\n        });\n        this.renderCalendar();\n      },\n      error: (err) => console.error('Error cargando disponibilidad del profesor', err)\n    });\n  }\n\n  formatDateKey(date: Date): string {\n    const year = date.getFullYear();\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const day = date.getDate().toString().padStart(2, '0');\n    return `${year}-${month}-${day}`;\n  }\n\n  renderCalendar(): void {\n    const year = this.currentDate.getFullYear();\n    const month = this.currentDate.getMonth();\n    const firstDay = new Date(year, month, 1);\n    const lastDay = new Date(year, month + 1, 0);\n\n    let startDay = firstDay.getDay();\n    startDay = startDay === 0 ? 6 : startDay - 1;\n\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    this.calendarDays = [];\n\n    for (let i = 0; i < startDay; i++) {\n      this.calendarDays.push({ day: 0, disabled: false, empty: true, hasSlots: false });\n    }\n\n    for (let day = 1; day <= lastDay.getDate(); day++) {\n      const currentDayDate = new Date(year, month, day);\n      const dateKey = this.formatDateKey(currentDayDate);\n      const hasSlots = this.publishedAvailability.has(dateKey);\n      const disabled = currentDayDate < today && !this.isSameDay(currentDayDate, today);\n\n      this.calendarDays.push({ day, disabled, empty: false, hasSlots });\n    }\n  }\n\n  isSameDay(d1: Date, d2: Date) {\n    return d1.getFullYear() === d2.getFullYear() &&\n      d1.getMonth() === d2.getMonth() &&\n      d1.getDate() === d2.getDate();\n  }\n\n  prevMonth(): void {\n    this.currentDate.setMonth(this.currentDate.getMonth() - 1);\n    this.renderCalendar();\n  }\n\n  nextMonth(): void {\n    this.currentDate.setMonth(this.currentDate.getMonth() + 1);\n    this.renderCalendar();\n  }\n\n  selectDay(day: { day: number, disabled: boolean, empty: boolean }): void {\n    if (day.disabled || day.empty) return;\n    this.selectedDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), day.day);\n\n    const dateKey = this.formatDateKey(this.selectedDate);\n    this.selectedHours = [...(this.publishedAvailability.get(dateKey) || [])];\n  }\n\n  toggleHour(hour: string): void {\n    const index = this.selectedHours.indexOf(hour);\n    if (index > -1) {\n      this.selectedHours.splice(index, 1);\n    } else {\n      this.selectedHours.push(hour);\n    }\n  }\n\n  saveAvailability(): void {\n    if (!this.selectedDate || this.selectedHours.length === 0) {\n      this.modalService.alert('Atención', 'Por favor, selecciona una fecha y al menos una hora.');\n      return;\n    }\n\n    const fechaStr = this.formatDateKey(this.selectedDate);\n    const dateKey = this.formatDateKey(this.selectedDate);\n    const existingHours = this.publishedAvailability.get(dateKey) || [];\n\n    // Ver cuáles son nuevas (están en selectedHours pero no en existingHours)\n    const newHours = this.selectedHours.filter(h => !existingHours.includes(h));\n\n    if (newHours.length === 0) {\n      this.modalService.alert('Información', 'No has añadido horas nuevas para esta fecha.');\n      return;\n    }\n\n    this.modalService.confirm(\n      'Publicar disponibilidad',\n      `¿Deseas publicar ${newHours.length} nuevo(s) hueco(s) para el ${fechaStr}?`,\n      'Publicar'\n    ).then(confirmed => {\n      if (confirmed) {\n        const requests = newHours.map(hora =>\n          this.disponibilidadService.crearDisponibilidad({\n            fecha: fechaStr,\n            hora: hora,\n            id_profesor: this.dniProfesor\n          })\n        );\n\n        forkJoin(requests).subscribe({\n          next: () => {\n            this.modalService.alert('Éxito', 'Disponibilidad publicada correctamente.');\n            this.loadProfessorAvailability();\n          },\n          error: (err) => {\n            console.error('Error al publicar disponibilidad', err);\n            this.modalService.alert('Error', 'Hubo un error al guardar la disponibilidad.');\n          }\n        });\n      }\n    });\n  }\n\n  getMonthYear(): string {\n    return `${this.monthNames[this.currentDate.getMonth()]} ${this.currentDate.getFullYear()}`;\n  }\n}","<main class=\"main-content\">\n  <div class=\"container\">\n    \n    <section class=\"calendar-section\">\n      <h2>Inglés Profesional</h2>\n      <div class=\"calendar\">\n        <div class=\"calendar-header\">\n          <button class=\"nav-btn-cal\" (click)=\"prevMonth()\">&lt;</button>\n          <h3>{{ getMonthYear() }}</h3>\n          <button class=\"nav-btn-cal\" (click)=\"nextMonth()\">&gt;</button>\n        </div>\n        \n        <div class=\"calendar-weekdays\">\n          <div class=\"weekday\">Lun</div>\n          <div class=\"weekday\">Mar</div>\n          <div class=\"weekday\">Mié</div>\n          <div class=\"weekday\">Jue</div>\n          <div class=\"weekday\">Vie</div>\n          <div class=\"weekday\">Sáb</div>\n          <div class=\"weekday\">Dom</div>\n        </div>\n        \n        <div class=\"calendar-days\">\n          <div\n            class=\"day\"\n            *ngFor=\"let day of calendarDays\"\n            [ngClass]=\"{\n              'empty': day.empty,\n              'disabled': day.disabled,\n              'available': !day.empty && !day.disabled,\n              'selected': selectedDate?.getDate() === day.day && !day.empty && !day.disabled\n            }\"\n            (click)=\"selectDay(day)\"\n          >\n            {{ day.empty ? '' : day.day }}\n          </div>\n        </div>\n      </div>\n    </section>\n\n    <aside class=\"hours-panel\">\n      <h2>Seleccione las horas libres</h2>\n      <div class=\"hours-container\">\n        <button \n          *ngFor=\"let h of hours\" \n          class=\"hour-btn\"\n          [class.selected]=\"selectedHours.includes(h)\"\n          (click)=\"toggleHour(h)\">\n          {{ h }}\n        </button>\n      </div>\n      <button class=\"confirm-btn\" (click)=\"confirmMeeting()\">Confirmar selección</button>\n    </aside>\n\n  </div>\n</main>"],"mappings":"AACA,SAASA,YAAY,QAAQ,iBAAiB;AAG9C,SAASC,QAAQ,QAAQ,MAAM;;;;;;;;;;;;;;;;ICmBrBC,EAAA,CAAAC,cAAA,cAUC;IADCD,EAAA,CAAAE,UAAA,mBAAAC,iEAAA;MAAA,MAAAC,WAAA,GAAAJ,EAAA,CAAAK,aAAA,CAAAC,GAAA;MAAA,MAAAC,MAAA,GAAAH,WAAA,CAAAI,SAAA;MAAA,MAAAC,MAAA,GAAAT,EAAA,CAAAU,aAAA;MAAA,OAASV,EAAA,CAAAW,WAAA,CAAAF,MAAA,CAAAG,SAAA,CAAAL,MAAA,CAAc;IAAA,EAAC;IAExBP,EAAA,CAAAa,MAAA,GACF;IAAAb,EAAA,CAAAc,YAAA,EAAM;;;;;IATJd,EAAA,CAAAe,UAAA,YAAAf,EAAA,CAAAgB,eAAA,IAAAC,GAAA,EAAAV,MAAA,CAAAW,KAAA,EAAAX,MAAA,CAAAY,QAAA,GAAAZ,MAAA,CAAAW,KAAA,KAAAX,MAAA,CAAAY,QAAA,GAAAC,MAAA,CAAAC,YAAA,kBAAAD,MAAA,CAAAC,YAAA,CAAAC,OAAA,QAAAf,MAAA,CAAAgB,GAAA,KAAAhB,MAAA,CAAAW,KAAA,KAAAX,MAAA,CAAAY,QAAA,EAKE;IAGFnB,EAAA,CAAAwB,SAAA,GACF;IADExB,EAAA,CAAAyB,kBAAA,MAAAlB,MAAA,CAAAW,KAAA,QAAAX,MAAA,CAAAgB,GAAA,MACF;;;;;;IAQFvB,EAAA,CAAAC,cAAA,iBAI0B;IAAxBD,EAAA,CAAAE,UAAA,mBAAAwB,uEAAA;MAAA,MAAAtB,WAAA,GAAAJ,EAAA,CAAAK,aAAA,CAAAsB,GAAA;MAAA,MAAAC,IAAA,GAAAxB,WAAA,CAAAI,SAAA;MAAA,MAAAqB,MAAA,GAAA7B,EAAA,CAAAU,aAAA;MAAA,OAASV,EAAA,CAAAW,WAAA,CAAAkB,MAAA,CAAAC,UAAA,CAAAF,IAAA,CAAa;IAAA,EAAC;IACvB5B,EAAA,CAAAa,MAAA,GACF;IAAAb,EAAA,CAAAc,YAAA,EAAS;;;;;IAHPd,EAAA,CAAA+B,WAAA,aAAAC,MAAA,CAAAC,aAAA,CAAAC,QAAA,CAAAN,IAAA,EAA4C;IAE5C5B,EAAA,CAAAwB,SAAA,GACF;IADExB,EAAA,CAAAyB,kBAAA,MAAAG,IAAA,MACF;;;ADpCR,OAAM,MAAOO,2BAA2B;EA4BtCC,YACUC,YAA0B,EAC1BC,qBAA4C;IAD5C,KAAAD,YAAY,GAAZA,YAAY;IACZ,KAAAC,qBAAqB,GAArBA,qBAAqB;IA5B/B,KAAAC,WAAW,GAAS,IAAIC,IAAI,EAAE;IAC9B,KAAAnB,YAAY,GAAgB,IAAI;IAChC,KAAAoB,WAAW,GAAW,EAAE;IAExB;IACA,KAAAR,aAAa,GAAa,EAAE;IAE5B;IACA,KAAAS,qBAAqB,GAA0B,IAAIC,GAAG,EAAE;IAExD,KAAAC,UAAU,GAAa,CACrB,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,OAAO,EACrD,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAE,SAAS,EAAE,WAAW,EAAE,WAAW,CACrE;IAED,KAAAC,YAAY,GAA4E,EAAE;IAE1F,KAAAC,KAAK,GAAa,CAChB,eAAe,EACf,eAAe,EACf,eAAe,EACf,eAAe,EACf,eAAe,EACf,eAAe,CAChB;EAKG;EAEJC,QAAQA,CAAA;IACN,IAAI,CAACN,WAAW,GAAGO,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE;IACpD,IAAI,IAAI,CAACR,WAAW,EAAE;MACpB,IAAI,CAACS,yBAAyB,EAAE;KACjC,MAAM;MACL,IAAI,CAACb,YAAY,CAACc,KAAK,CAAC,OAAO,EAAE,+DAA+D,CAAC;;EAErG;EAEAD,yBAAyBA,CAAA;IACvB,IAAI,CAACZ,qBAAqB,CAACc,cAAc,CAAC,IAAI,CAACX,WAAW,CAAC,CAACY,SAAS,CAAC;MACpEC,IAAI,EAAGC,KAAK,IAAI;QACd,IAAI,CAACb,qBAAqB,CAACc,KAAK,EAAE;QAClCD,KAAK,CAACE,OAAO,CAACC,IAAI,IAAG;UACnB,MAAMC,OAAO,GAAG,IAAInB,IAAI,CAACkB,IAAI,CAACE,KAAK,CAAC;UACpC,MAAMC,OAAO,GAAG,IAAI,CAACC,aAAa,CAACH,OAAO,CAAC;UAC3C,IAAI,CAAC,IAAI,CAACjB,qBAAqB,CAACqB,GAAG,CAACF,OAAO,CAAC,EAAE;YAC5C,IAAI,CAACnB,qBAAqB,CAACsB,GAAG,CAACH,OAAO,EAAE,EAAE,CAAC;;UAE7C,IAAI,CAACnB,qBAAqB,CAACuB,GAAG,CAACJ,OAAO,CAAC,EAAEK,IAAI,CAACR,IAAI,CAACS,IAAI,CAAC;QAC1D,CAAC,CAAC;QACF,IAAI,CAACC,cAAc,EAAE;MACvB,CAAC;MACDC,KAAK,EAAGC,GAAG,IAAKC,OAAO,CAACF,KAAK,CAAC,4CAA4C,EAAEC,GAAG;KAChF,CAAC;EACJ;EAEAR,aAAaA,CAACU,IAAU;IACtB,MAAMC,IAAI,GAAGD,IAAI,CAACE,WAAW,EAAE;IAC/B,MAAMC,KAAK,GAAG,CAACH,IAAI,CAACI,QAAQ,EAAE,GAAG,CAAC,EAAEC,QAAQ,EAAE,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;IAC/D,MAAMvD,GAAG,GAAGiD,IAAI,CAAClD,OAAO,EAAE,CAACuD,QAAQ,EAAE,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;IACtD,OAAO,GAAGL,IAAI,IAAIE,KAAK,IAAIpD,GAAG,EAAE;EAClC;EAEA6C,cAAcA,CAAA;IACZ,MAAMK,IAAI,GAAG,IAAI,CAAClC,WAAW,CAACmC,WAAW,EAAE;IAC3C,MAAMC,KAAK,GAAG,IAAI,CAACpC,WAAW,CAACqC,QAAQ,EAAE;IACzC,MAAMG,QAAQ,GAAG,IAAIvC,IAAI,CAACiC,IAAI,EAAEE,KAAK,EAAE,CAAC,CAAC;IACzC,MAAMK,OAAO,GAAG,IAAIxC,IAAI,CAACiC,IAAI,EAAEE,KAAK,GAAG,CAAC,EAAE,CAAC,CAAC;IAE5C,IAAIM,QAAQ,GAAGF,QAAQ,CAACG,MAAM,EAAE;IAChCD,QAAQ,GAAGA,QAAQ,KAAK,CAAC,GAAG,CAAC,GAAGA,QAAQ,GAAG,CAAC;IAE5C,MAAME,KAAK,GAAG,IAAI3C,IAAI,EAAE;IACxB2C,KAAK,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAE1B,IAAI,CAACvC,YAAY,GAAG,EAAE;IAEtB,KAAK,IAAIwC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,QAAQ,EAAEI,CAAC,EAAE,EAAE;MACjC,IAAI,CAACxC,YAAY,CAACqB,IAAI,CAAC;QAAE3C,GAAG,EAAE,CAAC;QAAEJ,QAAQ,EAAE,KAAK;QAAED,KAAK,EAAE,IAAI;QAAEoE,QAAQ,EAAE;MAAK,CAAE,CAAC;;IAGnF,KAAK,IAAI/D,GAAG,GAAG,CAAC,EAAEA,GAAG,IAAIyD,OAAO,CAAC1D,OAAO,EAAE,EAAEC,GAAG,EAAE,EAAE;MACjD,MAAMgE,cAAc,GAAG,IAAI/C,IAAI,CAACiC,IAAI,EAAEE,KAAK,EAAEpD,GAAG,CAAC;MACjD,MAAMsC,OAAO,GAAG,IAAI,CAACC,aAAa,CAACyB,cAAc,CAAC;MAClD,MAAMD,QAAQ,GAAG,IAAI,CAAC5C,qBAAqB,CAACqB,GAAG,CAACF,OAAO,CAAC;MACxD,MAAM1C,QAAQ,GAAGoE,cAAc,GAAGJ,KAAK,IAAI,CAAC,IAAI,CAACK,SAAS,CAACD,cAAc,EAAEJ,KAAK,CAAC;MAEjF,IAAI,CAACtC,YAAY,CAACqB,IAAI,CAAC;QAAE3C,GAAG;QAAEJ,QAAQ;QAAED,KAAK,EAAE,KAAK;QAAEoE;MAAQ,CAAE,CAAC;;EAErE;EAEAE,SAASA,CAACC,EAAQ,EAAEC,EAAQ;IAC1B,OAAOD,EAAE,CAACf,WAAW,EAAE,KAAKgB,EAAE,CAAChB,WAAW,EAAE,IAC1Ce,EAAE,CAACb,QAAQ,EAAE,KAAKc,EAAE,CAACd,QAAQ,EAAE,IAC/Ba,EAAE,CAACnE,OAAO,EAAE,KAAKoE,EAAE,CAACpE,OAAO,EAAE;EACjC;EAEAqE,SAASA,CAAA;IACP,IAAI,CAACpD,WAAW,CAACqD,QAAQ,CAAC,IAAI,CAACrD,WAAW,CAACqC,QAAQ,EAAE,GAAG,CAAC,CAAC;IAC1D,IAAI,CAACR,cAAc,EAAE;EACvB;EAEAyB,SAASA,CAAA;IACP,IAAI,CAACtD,WAAW,CAACqD,QAAQ,CAAC,IAAI,CAACrD,WAAW,CAACqC,QAAQ,EAAE,GAAG,CAAC,CAAC;IAC1D,IAAI,CAACR,cAAc,EAAE;EACvB;EAEAxD,SAASA,CAACW,GAAuD;IAC/D,IAAIA,GAAG,CAACJ,QAAQ,IAAII,GAAG,CAACL,KAAK,EAAE;IAC/B,IAAI,CAACG,YAAY,GAAG,IAAImB,IAAI,CAAC,IAAI,CAACD,WAAW,CAACmC,WAAW,EAAE,EAAE,IAAI,CAACnC,WAAW,CAACqC,QAAQ,EAAE,EAAErD,GAAG,CAACA,GAAG,CAAC;IAElG,MAAMsC,OAAO,GAAG,IAAI,CAACC,aAAa,CAAC,IAAI,CAACzC,YAAY,CAAC;IACrD,IAAI,CAACY,aAAa,GAAG,CAAC,IAAI,IAAI,CAACS,qBAAqB,CAACuB,GAAG,CAACJ,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC;EAC3E;EAEA/B,UAAUA,CAACgE,IAAY;IACrB,MAAMC,KAAK,GAAG,IAAI,CAAC9D,aAAa,CAAC+D,OAAO,CAACF,IAAI,CAAC;IAC9C,IAAIC,KAAK,GAAG,CAAC,CAAC,EAAE;MACd,IAAI,CAAC9D,aAAa,CAACgE,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;KACpC,MAAM;MACL,IAAI,CAAC9D,aAAa,CAACiC,IAAI,CAAC4B,IAAI,CAAC;;EAEjC;EAEAI,gBAAgBA,CAAA;IACd,IAAI,CAAC,IAAI,CAAC7E,YAAY,IAAI,IAAI,CAACY,aAAa,CAACkE,MAAM,KAAK,CAAC,EAAE;MACzD,IAAI,CAAC9D,YAAY,CAACc,KAAK,CAAC,UAAU,EAAE,sDAAsD,CAAC;MAC3F;;IAGF,MAAMiD,QAAQ,GAAG,IAAI,CAACtC,aAAa,CAAC,IAAI,CAACzC,YAAY,CAAC;IACtD,MAAMwC,OAAO,GAAG,IAAI,CAACC,aAAa,CAAC,IAAI,CAACzC,YAAY,CAAC;IACrD,MAAMgF,aAAa,GAAG,IAAI,CAAC3D,qBAAqB,CAACuB,GAAG,CAACJ,OAAO,CAAC,IAAI,EAAE;IAEnE;IACA,MAAMyC,QAAQ,GAAG,IAAI,CAACrE,aAAa,CAACsE,MAAM,CAACC,CAAC,IAAI,CAACH,aAAa,CAACnE,QAAQ,CAACsE,CAAC,CAAC,CAAC;IAE3E,IAAIF,QAAQ,CAACH,MAAM,KAAK,CAAC,EAAE;MACzB,IAAI,CAAC9D,YAAY,CAACc,KAAK,CAAC,aAAa,EAAE,8CAA8C,CAAC;MACtF;;IAGF,IAAI,CAACd,YAAY,CAACoE,OAAO,CACvB,yBAAyB,EACzB,oBAAoBH,QAAQ,CAACH,MAAM,8BAA8BC,QAAQ,GAAG,EAC5E,UAAU,CACX,CAACM,IAAI,CAACC,SAAS,IAAG;MACjB,IAAIA,SAAS,EAAE;QACb,MAAMC,QAAQ,GAAGN,QAAQ,CAACO,GAAG,CAAC1C,IAAI,IAChC,IAAI,CAAC7B,qBAAqB,CAACwE,mBAAmB,CAAC;UAC7ClD,KAAK,EAAEwC,QAAQ;UACfjC,IAAI,EAAEA,IAAI;UACV4C,WAAW,EAAE,IAAI,CAACtE;SACnB,CAAC,CACH;QAED1C,QAAQ,CAAC6G,QAAQ,CAAC,CAACvD,SAAS,CAAC;UAC3BC,IAAI,EAAEA,CAAA,KAAK;YACT,IAAI,CAACjB,YAAY,CAACc,KAAK,CAAC,OAAO,EAAE,yCAAyC,CAAC;YAC3E,IAAI,CAACD,yBAAyB,EAAE;UAClC,CAAC;UACDmB,KAAK,EAAGC,GAAG,IAAI;YACbC,OAAO,CAACF,KAAK,CAAC,kCAAkC,EAAEC,GAAG,CAAC;YACtD,IAAI,CAACjC,YAAY,CAACc,KAAK,CAAC,OAAO,EAAE,6CAA6C,CAAC;UACjF;SACD,CAAC;;IAEN,CAAC,CAAC;EACJ;EAEA6D,YAAYA,CAAA;IACV,OAAO,GAAG,IAAI,CAACpE,UAAU,CAAC,IAAI,CAACL,WAAW,CAACqC,QAAQ,EAAE,CAAC,IAAI,IAAI,CAACrC,WAAW,CAACmC,WAAW,EAAE,EAAE;EAC5F;;;uBAhLWvC,2BAA2B,EAAAnC,EAAA,CAAAiH,iBAAA,CAAAC,EAAA,CAAAC,YAAA,GAAAnH,EAAA,CAAAiH,iBAAA,CAAAG,EAAA,CAAAC,qBAAA;IAAA;EAAA;;;YAA3BlF,2BAA2B;MAAAmF,SAAA;MAAAC,UAAA;MAAAC,QAAA,GAAAxH,EAAA,CAAAyH,mBAAA;MAAAC,KAAA;MAAAC,IAAA;MAAAC,MAAA;MAAAC,QAAA,WAAAC,qCAAAC,EAAA,EAAAC,GAAA;QAAA,IAAAD,EAAA;UCbxC/H,EAAA,CAAAC,cAAA,cAA2B;UAIjBD,EAAA,CAAAa,MAAA,8BAAkB;UAAAb,EAAA,CAAAc,YAAA,EAAK;UAC3Bd,EAAA,CAAAC,cAAA,aAAsB;UAEUD,EAAA,CAAAE,UAAA,mBAAA+H,6DAAA;YAAA,OAASD,GAAA,CAAArC,SAAA,EAAW;UAAA,EAAC;UAAC3F,EAAA,CAAAa,MAAA,QAAI;UAAAb,EAAA,CAAAc,YAAA,EAAS;UAC/Dd,EAAA,CAAAC,cAAA,SAAI;UAAAD,EAAA,CAAAa,MAAA,IAAoB;UAAAb,EAAA,CAAAc,YAAA,EAAK;UAC7Bd,EAAA,CAAAC,cAAA,iBAAkD;UAAtBD,EAAA,CAAAE,UAAA,mBAAAgI,8DAAA;YAAA,OAASF,GAAA,CAAAnC,SAAA,EAAW;UAAA,EAAC;UAAC7F,EAAA,CAAAa,MAAA,SAAI;UAAAb,EAAA,CAAAc,YAAA,EAAS;UAGjEd,EAAA,CAAAC,cAAA,cAA+B;UACRD,EAAA,CAAAa,MAAA,WAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAC9Bd,EAAA,CAAAC,cAAA,cAAqB;UAAAD,EAAA,CAAAa,MAAA,WAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAC9Bd,EAAA,CAAAC,cAAA,cAAqB;UAAAD,EAAA,CAAAa,MAAA,gBAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAC9Bd,EAAA,CAAAC,cAAA,cAAqB;UAAAD,EAAA,CAAAa,MAAA,WAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAC9Bd,EAAA,CAAAC,cAAA,cAAqB;UAAAD,EAAA,CAAAa,MAAA,WAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAC9Bd,EAAA,CAAAC,cAAA,cAAqB;UAAAD,EAAA,CAAAa,MAAA,gBAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAC9Bd,EAAA,CAAAC,cAAA,cAAqB;UAAAD,EAAA,CAAAa,MAAA,WAAG;UAAAb,EAAA,CAAAc,YAAA,EAAM;UAGhCd,EAAA,CAAAC,cAAA,cAA2B;UACzBD,EAAA,CAAAmI,UAAA,KAAAC,2CAAA,iBAYM;UACRpI,EAAA,CAAAc,YAAA,EAAM;UAIVd,EAAA,CAAAC,cAAA,iBAA2B;UACrBD,EAAA,CAAAa,MAAA,mCAA2B;UAAAb,EAAA,CAAAc,YAAA,EAAK;UACpCd,EAAA,CAAAC,cAAA,eAA6B;UAC3BD,EAAA,CAAAmI,UAAA,KAAAE,8CAAA,qBAMS;UACXrI,EAAA,CAAAc,YAAA,EAAM;UACNd,EAAA,CAAAC,cAAA,kBAAuD;UAA3BD,EAAA,CAAAE,UAAA,mBAAAoI,8DAAA;YAAA,OAASN,GAAA,CAAAO,cAAA,EAAgB;UAAA,EAAC;UAACvI,EAAA,CAAAa,MAAA,gCAAmB;UAAAb,EAAA,CAAAc,YAAA,EAAS;;;UA3C3Ed,EAAA,CAAAwB,SAAA,IAAoB;UAApBxB,EAAA,CAAAwI,iBAAA,CAAAR,GAAA,CAAAhB,YAAA,GAAoB;UAiBNhH,EAAA,CAAAwB,SAAA,IAAe;UAAfxB,EAAA,CAAAe,UAAA,YAAAiH,GAAA,CAAAnF,YAAA,CAAe;UAmBnB7C,EAAA,CAAAwB,SAAA,GAAQ;UAARxB,EAAA,CAAAe,UAAA,YAAAiH,GAAA,CAAAlF,KAAA,CAAQ;;;qBDnCpBhD,YAAY,EAAA2I,EAAA,CAAAC,OAAA,EAAAD,EAAA,CAAAE,OAAA;MAAAC,MAAA;IAAA;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}